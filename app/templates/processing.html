{% extends "base.html" %}
{% block title %}Proccessing{% endblock %}

{% block content %}

<div class="text-center">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="sr-only">Loading...</span>
    </div>
</div>
<div class="text-center mt-1">
    <p id="msgProgress"></p>
</div>

{% endblock %}

{% block script %}

<script>

    let timer

    $(function () {
        timer = setInterval(check_status, 1000*2)
    })

    // request for current status every 2 sec
    const check_status = () => {
        let requestUrl = "/status"
        $.get(requestUrl, (res)=>{
            console.log(res)
            if (res.status == "SCRAWLING") {
                $("#msgProgress").text(`Scrawling articles...${res.progress}%`)
            } else {
                clearInterval(timer)
                window.location.href = "/result"
            }
        })
    }

</script>

{% endblock %}
