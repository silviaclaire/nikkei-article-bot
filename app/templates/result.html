{% extends "base.html" %}
{% block title %}Result{% endblock %}

{% block content %}

{% if result %}

{{ result }}

<button id="btnDownload" class="btn btn-primary">Download CSV</button>

{% else %}

<div class="alert alert-info" role="alert">
    No results yet.
</div>

{% endif %}

{% endblock %}

{% block script %}
<script>

    let requestUrl

    $("#btnDownload").on("click", ()=>{
        requestUrl = `/download?data=result`
        $.get(requestUrl, (data)=>{
            // use blob object to avoid href"s length limit
            let csvData = new Blob([data], {type:"text/csv;charset=utf-8"})
            let a = document.createElement("a")
            a.download = `result.csv`
            a.href = URL.createObjectURL(csvData)
            a.click()
        })
    })

</script>
{% endblock %}
